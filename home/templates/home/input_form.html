<!-- <!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Form</title>
    <script>
        const socket = new WebSocket('ws://127.0.0.1:8001/ws/run_script/');

        socket.onopen = function(event) {
            console.log("WebSocket is open now.");
        };

        socket.onclose = function(event) {
            console.log("WebSocket is closed now.");
        };
        
        socket.onmessage = function(event) {
            const data = JSON.parse(event.data);
            console.log("Received data:", data);  // Log received data
            const outputElement = document.getElementById('output');
            console.log("Output Element: ", outputElement);  // Log the element
            outputElement.innerHTML += data.output + "<br>";  // Update the HTML element
        };

        socket.onerror = function(event) {
            console.error("WebSocket error observed:", event);
        };

        function sendInput() {
            const userInput = document.getElementById('user_input').value;
            socket.send(JSON.stringify({'input': userInput}));
        }


    </script>
</head>
<body>
    <h1>Enter Input for Python Script</h1>
    <form onsubmit="sendInput(); return false;">
        {% csrf_token %}
        <input type="text" id="user_input" name="user_input">
        <button type="submit">Run Script</button>
    </form>
    <pre id="output">Waiting for script output...</pre>
</body>
</html> -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Form</title>
    <style>
        pre {
            height: 300px;
            overflow-y: scroll;
            white-space: pre-wrap;
            border: 1px solid #ccc; /* Optional: for better visualization */
            padding: 10px; /* Optional: for better visualization */
        }
    </style>
    <script>
        const socket = new WebSocket('ws://127.0.0.1:8001/ws/run_script/');

        socket.onopen = function(event) {
            console.log("WebSocket is open now.");
        };

        socket.onclose = function(event) {
            console.log("WebSocket is closed now.");
        };

        socket.onmessage = function(event) {
            const data = JSON.parse(event.data);
            console.log("Received data:", data);  // Log received data
            const outputElement = document.getElementById("output");
            outputElement.innerHTML += data.output + "<br>";  // Append output with newline

            // Scroll to the bottom of the output to make new messages visible
            outputElement.scrollTop = outputElement.scrollHeight;
        };

        socket.onerror = function(event) {
            console.error("WebSocket error observed:", event);
        };

        function sendInput() {
            const userInput = document.getElementById('user_input').value;
            console.log("User input: ", userInput);  // Log user input for debugging
            socket.send(JSON.stringify({'input': userInput}));
        }
    </script>
</head>
<body>
    <h1>Enter Input for Python Script</h1>
    <form onsubmit="sendInput(); return false;">
        {% csrf_token %}
        <input type="text" id="user_input" name="user_input">
        <button type="submit">Run Script</button>
    </form>
    <pre id="output">Waiting for script output...
        {{ output }}
    </pre>
</body>
</html> -->
<!-- <!DOCTYPE html> DZIALA!
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Real-time Data</title>
    <script>
        const socket = new WebSocket('ws://127.0.0.1:8001/ws/data/');

        socket.onmessage = function(event) {
            const data = JSON.parse(event.data);
            document.getElementById('data').innerText = data.message;
        };
    </script>
</head>
<body>
    <h1>Real-time Data</h1>
    <div id="data">Waiting for data...</div>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Real-time Data</title>
    <style>
        .progress-container {
            width: 100%;
            background-color: #f3f3f3;
            border-radius: 5px;
        }
        .progress-bar {
            width: 0;
            height: 20px;
            background-color: #4caf50;
            text-align: center;
            line-height: 20px;
            color: white;
            border-radius: 5px;
        }
    </style>
    <script>
        const progressBar = document.getElementById('progressBar');
        document.addEventListener("DOMContentLoaded", function () {

            const socket = new WebSocket('ws://127.0.0.1:8001/ws/progress/');

            socket.onmessage = function(event) {
                const data = JSON.parse(event.data);
                console.log(data.message);  // Should print "WebSocket connection successful!"
                // document.getElementById('data').innerText += data.message + "\n";
                console.log("Received progress:", progress);  // Debug log

                const progress = data.progress;
                progressBar.style.width = progress + '%';
                progressBar.innerHTML = progress + '%';

                if (progress >= 100) {
                    socket.close();  // Close connection when complete
                }
            };
        });
    </script>
</head>
<body>
    <div class="progress-container">
        <div class="progress-bar" id="progressBar">0%</div>
    </div>
    <!-- <h1>Real-time Data</h1>
    <div id="data">Waiting for data...</div> -->
</body>
</html>